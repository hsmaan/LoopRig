<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LoopRig Tutorial: Enhancer-Promoter Interactions â€¢ LoopRig</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="LoopRig Tutorial: Enhancer-Promoter Interactions">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LoopRig</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/LoopRig_Tutorial.html">LoopRig Tutorial: Enhancer-Promoter Interactions</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>LoopRig Tutorial: Enhancer-Promoter Interactions</h1>
            
      
      
      <div class="hidden name"><code>LoopRig_Tutorial.Rmd</code></div>

    </div>

    
    
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p>High-throughput interaction data from novel chromosome interaction assays has become a staple in genomics research. Methods such as high-throughput chromosome conformation capture (Hi-C) and chromatin interaction analysis by paired-end tag sequencing (ChIA-PET) provide researchers with a way of quantifying three-dimensional chromatin architecture, while also gaining insights into which regions in the genome are interacting frequently. A common downstream data-type from these experimental methods is chromatin loop data. Loops are inferred by marking regions in the genome with high frequency of interaction compared to a background. Typically, we are interested in loops because they provide an insulated environment for interaction of genomic regions, as well as a direct mode of contact for regions near the loop anchors. A classic canonical chromatin loop interaction is one that involves enhancer-promoter interactions in the regulation of gene expression. Therefore, a very common workflow involving chromatin loop data is the integration and concurrent analysis of genomic element data.</p>
<p>However, this poses two current challenges that are not readily solved by packages available in CRAN or Bioconductor:</p>
<ol style="list-style-type: decimal">
<li><p>Genomic interaction data involves two sets of coordinates at the same time, and current widely used tools such as the GenomicRanges package do not have readily available functions to handle this data-type.</p></li>
<li><p>Typical analysis workflows involving chromatin loop and genomic element data will incorporate multiple looping and element datasets at a time. This introduces another challenge for available software.</p></li>
</ol>
<p>LoopRig leverages the GenomicRanges and IRanges packages to standardize workflows utilizing chromatin loop and element data. This vignette covers all functional aspects of LoopRig by going over a workflow of a canonical mechanism of genomic interaction - enhancer &lt;-&gt; promoter interactions.</p>
</div>
<div id="creating-s3-element-and-loop-objects" class="section level2">
<h2 class="hasAnchor">
<a href="#creating-s3-element-and-loop-objects" class="anchor"></a>Creating S3 Element and Loop Objects</h2>
<p>Tab-delimited element data files in BED3..n format and loop data files in BEDPE format are required, meaning that the data files cannot have headers. Element data files can have any numbers of extra metadata columns apart from the required 3 columns (chr, start, end). Similarly, BEDPE interaction files have no limit on their metadata columns but must contain the required 6 columns at a minimum (chr1, start1, end1, chr2, start2, end2). The number of extra columns must be specified when calling the <code><a href="../reference/LoopsToRanges.html">LoopsToRanges()</a></code> and <code><a href="../reference/ElementsToRanges.html">ElementsToRanges()</a></code> using the <code>custom_cols</code> parameter. Additionally, metadata from the BED files can be attached to the <em>GRanges</em> objects to be created by specifying which BED file columns to include using the <code>custom_mcols</code> parameter. The example files included with this package comprise of three looping datasets with no extra columns, and two element datasets with one extra column.</p>
<p>LoopRig has two central S3 classes of objects - <em>LoopRanges</em> objects for storing loop data, and <em>ElementRanges</em> objects for storing element data. Each class comprises of lists of S4 <em>GRanges</em> objects from the GenomicRanges package. Multiple element and looping data can be stored into both object types using the <code><a href="../reference/LoopsToRanges.html">LoopsToRanges()</a></code> and <code><a href="../reference/ElementsToRanges.html">ElementsToRanges()</a></code> functions. The following examples go over creating these data objects using example chromatin loop data of three datasets (ovary, pancreas, spleen) from Salameh et al. [1], and enhancer and promoter element data from the Pan-Cancer Analysis of Whole Genomes Consortium (PCAWG) [2]. <em>LoopRanges</em> objects can be created using <code><a href="../reference/LoopsToRanges.html">LoopsToRanges()</a></code>:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(LoopRig)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co"># Load example files for chromatin loop data. These are BEDPE files with no extra</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co"># columns.</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">ovary_loops &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata/loops"</span>, <span class="st">"ovary_hg19.bedpe"</span>, <span class="dt">package =</span> <span class="st">"LoopRig"</span>, </a>
<a class="sourceLine" id="cb1-6" data-line-number="6">    <span class="dt">mustWork =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">pancreas_loops &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata/loops"</span>, <span class="st">"pancreas_hg19.bedpe"</span>, <span class="dt">package =</span> <span class="st">"LoopRig"</span>, </a>
<a class="sourceLine" id="cb1-8" data-line-number="8">    <span class="dt">mustWork =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-9" data-line-number="9">spleen_loops &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata/loops"</span>, <span class="st">"spleen_hg19.bedpe"</span>, <span class="dt">package =</span> <span class="st">"LoopRig"</span>, </a>
<a class="sourceLine" id="cb1-10" data-line-number="10">    <span class="dt">mustWork =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="co"># Call LoopsToRanges() on all files at once. Since there are custom columns, we</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="co"># indicate this by custom_cols = 0.</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14">loops &lt;-<span class="st"> </span><span class="kw"><a href="../reference/LoopsToRanges.html">LoopsToRanges</a></span>(ovary_loops, pancreas_loops, spleen_loops, <span class="dt">custom_cols =</span> <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb1-15" data-line-number="15">    <span class="dt">loop_names =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"ovary"</span>, <span class="st">"pancreas"</span>, <span class="st">"spleen"</span>))</a>
<a class="sourceLine" id="cb1-16" data-line-number="16"></a>
<a class="sourceLine" id="cb1-17" data-line-number="17"><span class="co"># View LoopRanges object for first loop dataset (ovary).</span></a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(loops, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-19" data-line-number="19"><span class="co">#&gt; $ovary</span></a>
<a class="sourceLine" id="cb1-20" data-line-number="20"><span class="co">#&gt; GRangesList object of length 2:</span></a>
<a class="sourceLine" id="cb1-21" data-line-number="21"><span class="co">#&gt; $Anchor 1 </span></a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="co">#&gt; GRanges object with 5648 ranges and 0 metadata columns:</span></a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="co">#&gt;          seqnames              ranges strand</span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="co">#&gt;             &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt;</span></a>
<a class="sourceLine" id="cb1-25" data-line-number="25"><span class="co">#&gt;      [1]     chr5   14140109-14150109      *</span></a>
<a class="sourceLine" id="cb1-26" data-line-number="26"><span class="co">#&gt;      [2]     chr5   29850107-29860107      *</span></a>
<a class="sourceLine" id="cb1-27" data-line-number="27"><span class="co">#&gt;      [3]     chr5 158137008-158147008      *</span></a>
<a class="sourceLine" id="cb1-28" data-line-number="28"><span class="co">#&gt;      [4]     chr5 158197008-158207008      *</span></a>
<a class="sourceLine" id="cb1-29" data-line-number="29"><span class="co">#&gt;      [5]     chr5 158167008-158177008      *</span></a>
<a class="sourceLine" id="cb1-30" data-line-number="30"><span class="co">#&gt;      ...      ...                 ...    ...</span></a>
<a class="sourceLine" id="cb1-31" data-line-number="31"><span class="co">#&gt;   [5644]     chr4   78621154-78631154      *</span></a>
<a class="sourceLine" id="cb1-32" data-line-number="32"><span class="co">#&gt;   [5645]     chr4   33601622-33611622      *</span></a>
<a class="sourceLine" id="cb1-33" data-line-number="33"><span class="co">#&gt;   [5646]     chr4   41452017-41462017      *</span></a>
<a class="sourceLine" id="cb1-34" data-line-number="34"><span class="co">#&gt;   [5647]     chr4   99321151-99331151      *</span></a>
<a class="sourceLine" id="cb1-35" data-line-number="35"><span class="co">#&gt;   [5648]     chr4 169501151-169511151      *</span></a>
<a class="sourceLine" id="cb1-36" data-line-number="36"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb1-37" data-line-number="37"><span class="co">#&gt; ...</span></a>
<a class="sourceLine" id="cb1-38" data-line-number="38"><span class="co">#&gt; &lt;1 more element&gt;</span></a>
<a class="sourceLine" id="cb1-39" data-line-number="39"><span class="co">#&gt; -------</span></a>
<a class="sourceLine" id="cb1-40" data-line-number="40"><span class="co">#&gt; seqinfo: 23 sequences from an unspecified genome; no seqlengths</span></a>
<a class="sourceLine" id="cb1-41" data-line-number="41"></a>
<a class="sourceLine" id="cb1-42" data-line-number="42"><span class="co"># We can see that each element in the LoopRanges list contains the loops from a</span></a>
<a class="sourceLine" id="cb1-43" data-line-number="43"><span class="co"># given dataset, in this case the ovarian loops.</span></a>
<a class="sourceLine" id="cb1-44" data-line-number="44"></a>
<a class="sourceLine" id="cb1-45" data-line-number="45"><span class="co"># We can confirm the class of our object by using the class() function.</span></a>
<a class="sourceLine" id="cb1-46" data-line-number="46"><span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span>(loops)</a>
<a class="sourceLine" id="cb1-47" data-line-number="47"><span class="co">#&gt; [1] "LoopRanges"</span></a></code></pre></div>
<p>Each chromatin loop data set is stored as a <em>GRangesList</em> object within the <em>LoopRanges</em> object. Similarly for elements using <code><a href="../reference/ElementsToRanges.html">ElementsToRanges()</a></code>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># Load example files for genomic element data. These are BED4 files, indicating</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co"># they have one extra column for metadata.</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">enhancers &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata/elements"</span>, <span class="st">"enhancers.bed"</span>, <span class="dt">package =</span> <span class="st">"LoopRig"</span>, </a>
<a class="sourceLine" id="cb2-4" data-line-number="4">    <span class="dt">mustWork =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">promoters &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata/elements"</span>, <span class="st">"promoters.bed"</span>, <span class="dt">package =</span> <span class="st">"LoopRig"</span>, </a>
<a class="sourceLine" id="cb2-6" data-line-number="6">    <span class="dt">mustWork =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb2-7" data-line-number="7"></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co"># Call ElementsToRanges() on all files at once. We must specify that there is one</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co"># extra column by custom_cols = 1. We want to use this column as metadata for our</span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co"># object, so we indicate this by custom_mcols = 4, meaning that the metadata</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co"># columns for our ElementRanges object will be from column 4 of the original BED</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co"># files.</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">element_ranges &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ElementsToRanges.html">ElementsToRanges</a></span>(enhancers, promoters, <span class="dt">element_names =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"enhancers"</span>, </a>
<a class="sourceLine" id="cb2-14" data-line-number="14">    <span class="st">"promoters"</span>), <span class="dt">custom_cols =</span> <span class="dv">1</span>, <span class="dt">custom_mcols =</span> <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb2-15" data-line-number="15"></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co"># View ElementRanges object for first element type (enhancers).</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(element_ranges, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co">#&gt; $enhancers</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19"><span class="co">#&gt; GRanges object with 1000 ranges and 1 metadata column:</span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co">#&gt;          seqnames              ranges strand |       mcols</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21"><span class="co">#&gt;             &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;</span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co">#&gt;      [1]     chr2   48752479-48807772      * |        E573</span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23"><span class="co">#&gt;      [2]     chrX     9000916-9002368      * |       E1383</span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="co">#&gt;      [3]     chr4   84406018-84406908      * |       E6724</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25"><span class="co">#&gt;      [4]    chr15   90773255-90784140      * |       E3155</span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26"><span class="co">#&gt;      [5]     chr1 112525348-112535556      * |       E8752</span></a>
<a class="sourceLine" id="cb2-27" data-line-number="27"><span class="co">#&gt;      ...      ...                 ...    ... .         ...</span></a>
<a class="sourceLine" id="cb2-28" data-line-number="28"><span class="co">#&gt;    [996]    chr12   50781274-50836617      * |       E9077</span></a>
<a class="sourceLine" id="cb2-29" data-line-number="29"><span class="co">#&gt;    [997]     chr6 150067458-150068014      * |       E1642</span></a>
<a class="sourceLine" id="cb2-30" data-line-number="30"><span class="co">#&gt;    [998]    chr17   34263213-34274392      * |       E6285</span></a>
<a class="sourceLine" id="cb2-31" data-line-number="31"><span class="co">#&gt;    [999]     chr3 192954838-192959007      * |       E5603</span></a>
<a class="sourceLine" id="cb2-32" data-line-number="32"><span class="co">#&gt;   [1000]     chr1 204432559-204468852      * |        E281</span></a>
<a class="sourceLine" id="cb2-33" data-line-number="33"><span class="co">#&gt;   -------</span></a>
<a class="sourceLine" id="cb2-34" data-line-number="34"><span class="co">#&gt;   seqinfo: 25 sequences from an unspecified genome; no seqlengths</span></a>
<a class="sourceLine" id="cb2-35" data-line-number="35"></a>
<a class="sourceLine" id="cb2-36" data-line-number="36"><span class="co"># As we can see, we have metadata for the GRanges object that stores element</span></a>
<a class="sourceLine" id="cb2-37" data-line-number="37"><span class="co"># information.</span></a>
<a class="sourceLine" id="cb2-38" data-line-number="38"></a>
<a class="sourceLine" id="cb2-39" data-line-number="39"><span class="co"># Confirm object class.</span></a>
<a class="sourceLine" id="cb2-40" data-line-number="40"><span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span>(element_ranges)</a>
<a class="sourceLine" id="cb2-41" data-line-number="41"><span class="co">#&gt; [1] "ElementRanges"</span></a></code></pre></div>
<p>Similar to <em>LoopRanges</em>, <em>ElementRanges</em> objects comprise of a list of <em>GRanges</em> objects storing genomic element coordinates. These two objects can easily be subset, and users experienced in the GenomicRanges package can use the wealth of functions it provides. However, this is not advised unless there is a non-trivial analysis that must be performed which LoopRig does not address.</p>
</div>
<div id="subsetting-loops-and-determining-consensus-sets" class="section level2">
<h2 class="hasAnchor">
<a href="#subsetting-loops-and-determining-consensus-sets" class="anchor"></a>Subsetting Loops and Determining Consensus Sets</h2>
<p>Thereâ€™s a wealth of publicly available chromatin loop data, and one of the most important challenges is extracting high-confidence interactions. LoopRig provides a function, <code><a href="../reference/ConsensusLoops.html">ConsensusLoops()</a></code>, which can be used on objects of <em>LoopRanges</em> class. This function has a number of options and consensus can be determined using a variety of methods. The most basic methods comprises of determining which loops in one dataset overlap with those in the other dataset, and those that meet the <code>stringency</code> threshold parameter are considered consensus loops. Another metric central to <code><a href="../reference/ConsensusLoops.html">ConsensusLoops()</a></code> and most other functions in LoopRig is the <code>overlap_threshold</code> parameter, which defines how many nucleotide positions must be overlapping between two loci to constitute a â€˜hitâ€™. In the case of <code><a href="../reference/ConsensusLoops.html">ConsensusLoops()</a></code>, this indicates the threshold for nucleotide overlap of both chromatin loop anchors for loops to be considered overlapping with others across datasets. To determine a set of consensus loops from our <em>LoopRanges</em> object created earlier, we can call <code><a href="../reference/ConsensusLoops.html">ConsensusLoops()</a></code> with minimal parameters:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># Call the ConsensusLoops() function. Stringency indicates how many datasets a</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co"># loop must be present in to be considered a consensus loop, and the overlap</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co"># threshold (nucleotides) defines a *hit* across datasets. In this case, a loop</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co"># must be present in at least 2 datasets based on overlap with another of 1</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co"># nucleotide.</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6">consensus_loops &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ConsensusLoops.html">ConsensusLoops</a></span>(<span class="dt">loop_ranges =</span> loops, <span class="dt">stringency =</span> <span class="dv">2</span>, <span class="dt">overlap_threshold =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-7" data-line-number="7"></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co"># View consensus_loops.</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(consensus_loops, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">#&gt; $Consensus</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">#&gt; GRangesList object of length 2:</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">#&gt; $Anchor 1 </span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">#&gt; GRanges object with 68 ranges and 0 metadata columns:</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">#&gt;        seqnames              ranges strand</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">#&gt;           &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt;</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">#&gt;    [1]    chr11 120530709-120540709      *</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">#&gt;    [2]     chr7   95139312-95149312      *</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"><span class="co">#&gt;    [3]    chr20   36698402-36708402      *</span></a>
<a class="sourceLine" id="cb3-19" data-line-number="19"><span class="co">#&gt;    [4]    chr17   17773314-17783314      *</span></a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">#&gt;    [5]     chr8 121702240-121712240      *</span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">#&gt;    ...      ...                 ...    ...</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="co">#&gt;   [64]     chr4 185251153-185261153      *</span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co">#&gt;   [65]     chr4   26741622-26751622      *</span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="co">#&gt;   [66]    chr12   64943780-64953780      *</span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="co">#&gt;   [67]    chr11 111500724-111510724      *</span></a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="co">#&gt;   [68]     chr7 121420054-121430054      *</span></a>
<a class="sourceLine" id="cb3-27" data-line-number="27"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb3-28" data-line-number="28"><span class="co">#&gt; ...</span></a>
<a class="sourceLine" id="cb3-29" data-line-number="29"><span class="co">#&gt; &lt;1 more element&gt;</span></a>
<a class="sourceLine" id="cb3-30" data-line-number="30"><span class="co">#&gt; -------</span></a>
<a class="sourceLine" id="cb3-31" data-line-number="31"><span class="co">#&gt; seqinfo: 23 sequences from an unspecified genome; no seqlengths</span></a>
<a class="sourceLine" id="cb3-32" data-line-number="32"></a>
<a class="sourceLine" id="cb3-33" data-line-number="33"><span class="co"># As we can see, we still have a LoopRanges object, but it only comprises of one</span></a>
<a class="sourceLine" id="cb3-34" data-line-number="34"><span class="co"># GRangesList object containing the consensus loop data. We can double-check this</span></a>
<a class="sourceLine" id="cb3-35" data-line-number="35"><span class="co"># using the length() function.</span></a>
<a class="sourceLine" id="cb3-36" data-line-number="36"><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(loops)</a>
<a class="sourceLine" id="cb3-37" data-line-number="37"><span class="co">#&gt; [1] 3</span></a>
<a class="sourceLine" id="cb3-38" data-line-number="38"><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(consensus_loops)</a>
<a class="sourceLine" id="cb3-39" data-line-number="39"><span class="co">#&gt; [1] 1</span></a>
<a class="sourceLine" id="cb3-40" data-line-number="40"></a>
<a class="sourceLine" id="cb3-41" data-line-number="41"><span class="co"># We can further check class to ensure LoopRanges object is intact.</span></a>
<a class="sourceLine" id="cb3-42" data-line-number="42"><span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span>(consensus_loops)</a>
<a class="sourceLine" id="cb3-43" data-line-number="43"><span class="co">#&gt; [1] "LoopRanges"</span></a></code></pre></div>
<p>The <code><a href="../reference/ConsensusLoops.html">ConsensusLoops()</a></code> function still returns an object of <em>LoopRanges</em> class, which can be used in many subsequent functions for analysis. The length of this <em>LoopRanges</em> object is 1, as it now only contains one dataset comprising of subset loops based on consensus.</p>
<p>LoopRig also provides another function for manipulating loop data in <em>LoopRanges</em> form - <code><a href="../reference/DropLoops.html">DropLoops()</a></code>. This function allows <em>LoopRanges</em> objects to be subset before or calling <code><a href="../reference/ConsensusLoops.html">ConsensusLoops()</a></code> (i.e.Â it can work with <em>LoopRanges</em> objects of any length except 0). Loops can be subset based on anchor size or total loop size, which is specified using the <code>type</code> parameter. We can consider an example of subsetting our consensus loops object for loop sizes that are between 100-200 Kb:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># Call DropLoops() and indicate the 'type' parameter to subset loops by loop size</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co"># and use the 'size' parameter to specify lengths to keep (0-10 Kb).</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">consensus_loops_dropped &lt;-<span class="st"> </span><span class="kw"><a href="../reference/DropLoops.html">DropLoops</a></span>(<span class="dt">loop_ranges =</span> consensus_loops, <span class="dt">type =</span> <span class="st">"loop_size"</span>, </a>
<a class="sourceLine" id="cb4-4" data-line-number="4">    <span class="dt">size =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1e+05</span>, <span class="fl">2e+05</span>))</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co"># We can view the change by determining how many loops are in each object. The</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co"># first index must be specified because we are still using LoopRanges list</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co"># objects, and we must index an anchor to determine a count.</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(consensus_loops[[<span class="dv">1</span>]][[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">#&gt; [1] 68</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(consensus_loops_dropped[[<span class="dv">1</span>]][[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">#&gt; [1] 41</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co"># Our total number of loops reduced from 68 to 41, and these 41 loops all have</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co"># total loop sizes (anchor end-to-end) between 100-200 Kb.</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co"># Recheck class of subset object.</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span>(consensus_loops_dropped)</a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">#&gt; [1] "LoopRanges"</span></a></code></pre></div>
<p>Similar to <code><a href="../reference/ConsensusLoops.html">ConsensusLoops()</a></code>, <code><a href="../reference/DropLoops.html">DropLoops()</a></code> returns object of <em>LoopRanges</em> class, which can be subset repeatedly using these two functions as much as necessary.</p>
</div>
<div id="finding-element-linkage-mediated-by-chromatin-loops" class="section level2">
<h2 class="hasAnchor">
<a href="#finding-element-linkage-mediated-by-chromatin-loops" class="anchor"></a>Finding Element Linkage Mediated by Chromatin Loops</h2>
<p>LoopRig provides three functions for linking elements datasets based on chromatin loops: <code><a href="../reference/LinkedElements.html">LinkedElements()</a></code>, <code><a href="../reference/StackedElements.html">StackedElements()</a></code>, and <code><a href="../reference/ScaffoldElements.html">ScaffoldElements()</a></code>. Each of these functions links elements based on chromatin loop overlap in different ways, but they all share the same parameters: input of a <em>LoopRanges</em> object of length 1 for the <code>loop_ranges</code> parameter (i.e.Â must be subset or have <code><a href="../reference/ConsensusLoops.html">ConsensusLoops()</a></code> called on it), input of two <em>GRanges</em> element objects for the <code>element_ranges_x</code> and <code>element_ranges_y</code> parameters (subset <em>ElementRanges</em> object using list indexing), an <code>overlap_threshold</code> parameter to determine degree of nucleotide overlap that counts as a hit, and <code>range_out_x</code> and <code>range_out_y</code> parameters which can be used to override the default dataframe outputs and instead output the subset elements as <em>ElementRanges</em> objects.</p>
<div id="anchor-anchor-linkage-using-linkedelements" class="section level3">
<h3 class="hasAnchor">
<a href="#anchor-anchor-linkage-using-linkedelements" class="anchor"></a>1. Anchor-Anchor Linkage Using <code>LinkedElements()</code>
</h3>
<p>The <code><a href="../reference/LinkedElements.html">LinkedElements()</a></code> function considers which elements from two datasets are linked by chromatin loop anchors. Based on input chromatin loops, if an element from one set coincides with a loop anchor and an element from the other set coincides with the opposite loop anchor, those two elements are considered linked. We can determine if any if our enhancers and promoters are linked in this manner using the consensus set of chromatin loops:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># Call LinkedElements() for the promoter and enhancer ranges in element_ranges</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co"># and use the default output parameters (dataframe). We must subset the</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co"># ElementRanges object we created initially, as it has both the enhancer (index</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co"># 1) and promoter (index 2) data in one object.</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">linked_elements &lt;-<span class="st"> </span><span class="kw"><a href="../reference/LinkedElements.html">LinkedElements</a></span>(<span class="dt">loop_ranges =</span> consensus_loops, <span class="dt">element_ranges_x =</span> element_ranges[[<span class="dv">1</span>]], </a>
<a class="sourceLine" id="cb5-6" data-line-number="6">    <span class="dt">element_ranges_y =</span> element_ranges[[<span class="dv">2</span>]])</a>
<a class="sourceLine" id="cb5-7" data-line-number="7"></a>
<a class="sourceLine" id="cb5-8" data-line-number="8">linked_elements</a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt;   Anchor_1 Anchor_2</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">#&gt; 1    E3762     KSR1</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co"># Using our consensus set of loops, enhancer data, and promoter data, we find</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co"># that the only linked elements are Enhancer 3762 and the promoter corresponding</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co"># to the KSR1 gene.</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co"># We can do the exact same analysis, but this time output the promoters subset by</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co"># this linkage instead of the dataframe indicating the links (i.e. the range</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"><span class="co"># corresponding to the KSR1 promoter).</span></a>
<a class="sourceLine" id="cb5-19" data-line-number="19">linked_elements_promoters &lt;-<span class="st"> </span><span class="kw"><a href="../reference/LinkedElements.html">LinkedElements</a></span>(<span class="dt">loop_ranges =</span> consensus_loops, <span class="dt">element_ranges_x =</span> element_ranges[[<span class="dv">1</span>]], </a>
<a class="sourceLine" id="cb5-20" data-line-number="20">    <span class="dt">element_ranges_y =</span> element_ranges[[<span class="dv">2</span>]], <span class="dt">range_out_y =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb5-21" data-line-number="21"></a>
<a class="sourceLine" id="cb5-22" data-line-number="22">linked_elements_promoters</a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="co">#&gt; $el_y_linked</span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="co">#&gt; GRanges object with 1 range and 1 metadata column:</span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25"><span class="co">#&gt;       seqnames            ranges strand |       mcols</span></a>
<a class="sourceLine" id="cb5-26" data-line-number="26"><span class="co">#&gt;          &lt;Rle&gt;         &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;</span></a>
<a class="sourceLine" id="cb5-27" data-line-number="27"><span class="co">#&gt;   [1]    chr17 25783469-25951167      * |        KSR1</span></a>
<a class="sourceLine" id="cb5-28" data-line-number="28"><span class="co">#&gt;   -------</span></a>
<a class="sourceLine" id="cb5-29" data-line-number="29"><span class="co">#&gt;   seqinfo: 25 sequences from an unspecified genome; no seqlengths</span></a>
<a class="sourceLine" id="cb5-30" data-line-number="30"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb5-31" data-line-number="31"><span class="co">#&gt; attr(,"class")</span></a>
<a class="sourceLine" id="cb5-32" data-line-number="32"><span class="co">#&gt; [1] "ElementRanges"</span></a>
<a class="sourceLine" id="cb5-33" data-line-number="33"></a>
<a class="sourceLine" id="cb5-34" data-line-number="34"><span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span>(linked_elements_promoters)</a>
<a class="sourceLine" id="cb5-35" data-line-number="35"><span class="co">#&gt; [1] "ElementRanges"</span></a>
<a class="sourceLine" id="cb5-36" data-line-number="36"></a>
<a class="sourceLine" id="cb5-37" data-line-number="37"><span class="co"># As we can see, the output this time is an ElementRanges object containing the</span></a>
<a class="sourceLine" id="cb5-38" data-line-number="38"><span class="co"># promoter data.</span></a></code></pre></div>
</div>
<div id="determining-elements-coinciding-on-loop-anchors-using-stackedelements" class="section level3">
<h3 class="hasAnchor">
<a href="#determining-elements-coinciding-on-loop-anchors-using-stackedelements" class="anchor"></a>2. Determining Elements Coinciding on Loop Anchors Using <code>StackedElements()</code>
</h3>
<p>The <code><a href="../reference/StackedElements.html">StackedElements()</a></code> function determines which elements are both overlapping with each other and with a chromatin loop anchor. Therefore, it considers which elements are â€˜stackedâ€™ on top of loop anchors. Using our enhancer and promoter element data and the consensus set of loops determined previously, we can determine if any of these elements are stacked on loop anchors:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># Call StackedElements() for the promoter and enhancer data by subsetting the</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co"># element_ranges object and using the consensus_loops object for the looping</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co"># data. The default output will be a dataframe object.</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">stacked_elements &lt;-<span class="st"> </span><span class="kw"><a href="../reference/StackedElements.html">StackedElements</a></span>(<span class="dt">loop_ranges =</span> consensus_loops, <span class="dt">element_ranges_x =</span> element_ranges[[<span class="dv">1</span>]], </a>
<a class="sourceLine" id="cb6-5" data-line-number="5">    <span class="dt">element_ranges_y =</span> element_ranges[[<span class="dv">2</span>]])</a>
<a class="sourceLine" id="cb6-6" data-line-number="6"></a>
<a class="sourceLine" id="cb6-7" data-line-number="7">stacked_elements</a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt;   Element_1 Element_2</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt; 1     E2564   RAPGEF4</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt; 2     E3762      KSR1</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt; 4     E5878      TGM2</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co"># From here, we can see that we have three instances of stacked promoters and</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co"># enhancers on our consensus loop anchors.</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co"># We can output which enhancers correspond to these stacks by using the</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co"># range_out_x parameter. This will output these enhancers as an ElementRanges</span></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"><span class="co"># object.</span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19">stacked_elements_enhancers &lt;-<span class="st"> </span><span class="kw"><a href="../reference/StackedElements.html">StackedElements</a></span>(<span class="dt">loop_ranges =</span> consensus_loops, <span class="dt">element_ranges_x =</span> element_ranges[[<span class="dv">1</span>]], </a>
<a class="sourceLine" id="cb6-20" data-line-number="20">    <span class="dt">element_ranges_y =</span> element_ranges[[<span class="dv">2</span>]], <span class="dt">range_out_x =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb6-21" data-line-number="21"></a>
<a class="sourceLine" id="cb6-22" data-line-number="22">stacked_elements_enhancers</a>
<a class="sourceLine" id="cb6-23" data-line-number="23"><span class="co">#&gt; $el_x_stacked</span></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"><span class="co">#&gt; GRanges object with 3 ranges and 1 metadata column:</span></a>
<a class="sourceLine" id="cb6-25" data-line-number="25"><span class="co">#&gt;       seqnames              ranges strand |       mcols</span></a>
<a class="sourceLine" id="cb6-26" data-line-number="26"><span class="co">#&gt;          &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;</span></a>
<a class="sourceLine" id="cb6-27" data-line-number="27"><span class="co">#&gt;   [1]     chr2 173600324-173896190      * |       E2564</span></a>
<a class="sourceLine" id="cb6-28" data-line-number="28"><span class="co">#&gt;   [2]    chr17   25783469-25951167      * |       E3762</span></a>
<a class="sourceLine" id="cb6-29" data-line-number="29"><span class="co">#&gt;   [3]    chr20   36788672-36799980      * |       E5878</span></a>
<a class="sourceLine" id="cb6-30" data-line-number="30"><span class="co">#&gt;   -------</span></a>
<a class="sourceLine" id="cb6-31" data-line-number="31"><span class="co">#&gt;   seqinfo: 25 sequences from an unspecified genome; no seqlengths</span></a>
<a class="sourceLine" id="cb6-32" data-line-number="32"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb6-33" data-line-number="33"><span class="co">#&gt; attr(,"class")</span></a>
<a class="sourceLine" id="cb6-34" data-line-number="34"><span class="co">#&gt; [1] "ElementRanges"</span></a>
<a class="sourceLine" id="cb6-35" data-line-number="35"></a>
<a class="sourceLine" id="cb6-36" data-line-number="36"><span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span>(stacked_elements_enhancers)</a>
<a class="sourceLine" id="cb6-37" data-line-number="37"><span class="co">#&gt; [1] "ElementRanges"</span></a></code></pre></div>
</div>
<div id="finding-scaffolded-loop-connections-using-scaffoldelements" class="section level3">
<h3 class="hasAnchor">
<a href="#finding-scaffolded-loop-connections-using-scaffoldelements" class="anchor"></a>3. Finding Scaffolded Loop Connections Using <code>ScaffoldElements()</code>
</h3>
<p>The least intuitive of the linkage functions is <code><a href="../reference/ScaffoldElements.html">ScaffoldElements()</a></code>. This function aims to determine a subset of the input loops which have anchors overlapping with the first element set (<code>element_ranges_x</code>), and then determines which elements in the second set (<code>element_ranges_y</code>) overlap with those subset loops. The â€˜linksâ€™ that are returned indicate the loop number, element from the first set that â€˜scaffoldsâ€™ that loop, and element in the second set that overlaps with that loop. This analysis is particularly useful when considering elements that may stabilize loops, such as CTCF sites. For demonstration purposes, we will consider our enhancers to be the scaffolds and determine which promoters are linked to the scaffolded loops using our consensus loop set:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="co"># Call ScaffoldElements() for the promoter and enhancer data using indexing and</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co"># use the consensus_loops object for the loop data. Use default options so the</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co"># output is a dataframe object.</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">scaffold_elements &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ScaffoldElements.html">ScaffoldElements</a></span>(<span class="dt">loop_ranges =</span> consensus_loops, <span class="dt">element_ranges_x =</span> element_ranges[[<span class="dv">1</span>]], </a>
<a class="sourceLine" id="cb7-5" data-line-number="5">    <span class="dt">element_ranges_y =</span> element_ranges[[<span class="dv">2</span>]])</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"></a>
<a class="sourceLine" id="cb7-7" data-line-number="7">scaffold_elements</a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt;   Element_1_Scaffold Element_2_Link</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt; 1              E5878           TGM2</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt; 2              E2564        RAPGEF4</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt; 3              E3762           KSR1</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co"># Similar to LinkedElements() and StackedElements(), we can output either the</span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co"># linked enhancers or promoters as ElementRanges objects.</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co"># Let's output the promoters using the range_out_y parameter.</span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17">scaffold_elements_promoters &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ScaffoldElements.html">ScaffoldElements</a></span>(<span class="dt">loop_ranges =</span> consensus_loops, <span class="dt">element_ranges_x =</span> element_ranges[[<span class="dv">1</span>]], </a>
<a class="sourceLine" id="cb7-18" data-line-number="18">    <span class="dt">element_ranges_y =</span> element_ranges[[<span class="dv">2</span>]], <span class="dt">range_out_y =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb7-19" data-line-number="19"></a>
<a class="sourceLine" id="cb7-20" data-line-number="20">scaffold_elements_promoters</a>
<a class="sourceLine" id="cb7-21" data-line-number="21"><span class="co">#&gt; $el_y_scaffold_linked</span></a>
<a class="sourceLine" id="cb7-22" data-line-number="22"><span class="co">#&gt; GRanges object with 3 ranges and 1 metadata column:</span></a>
<a class="sourceLine" id="cb7-23" data-line-number="23"><span class="co">#&gt;       seqnames              ranges strand |       mcols</span></a>
<a class="sourceLine" id="cb7-24" data-line-number="24"><span class="co">#&gt;          &lt;Rle&gt;           &lt;IRanges&gt;  &lt;Rle&gt; | &lt;character&gt;</span></a>
<a class="sourceLine" id="cb7-25" data-line-number="25"><span class="co">#&gt;   [1]    chr17   25783469-25951167      * |        KSR1</span></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"><span class="co">#&gt;   [2]    chr20   36788672-36799980      * |        TGM2</span></a>
<a class="sourceLine" id="cb7-27" data-line-number="27"><span class="co">#&gt;   [3]     chr2 173600324-173896190      * |     RAPGEF4</span></a>
<a class="sourceLine" id="cb7-28" data-line-number="28"><span class="co">#&gt;   -------</span></a>
<a class="sourceLine" id="cb7-29" data-line-number="29"><span class="co">#&gt;   seqinfo: 25 sequences from an unspecified genome; no seqlengths</span></a>
<a class="sourceLine" id="cb7-30" data-line-number="30"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb7-31" data-line-number="31"><span class="co">#&gt; attr(,"class")</span></a>
<a class="sourceLine" id="cb7-32" data-line-number="32"><span class="co">#&gt; [1] "ElementRanges"</span></a>
<a class="sourceLine" id="cb7-33" data-line-number="33"></a>
<a class="sourceLine" id="cb7-34" data-line-number="34"><span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span>(scaffold_elements_promoters)</a>
<a class="sourceLine" id="cb7-35" data-line-number="35"><span class="co">#&gt; [1] "ElementRanges"</span></a></code></pre></div>
</div>
</div>
<div id="exporting-element-and-loop-data" class="section level2">
<h2 class="hasAnchor">
<a href="#exporting-element-and-loop-data" class="anchor"></a>Exporting Element and Loop Data</h2>
<p>Once all relevant analysis has been done, <em>LoopRanges</em> and <em>ElementRanges</em> objects can be exported into BEDPE and BED files respectively using the <code><a href="../reference/ExportBED.html">ExportBED()</a></code> function. The index of the object must be specified using the <code>index</code> parameter, and the first metadata column of the object can be optionally appended to the exported BED file by indicating <code>mcol = TRUE</code>. For example, we can export our promoters linked to enhancers determined by the <code><a href="../reference/LinkedElements.html">LinkedElements()</a></code> function:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># Call ExportBED() for the linked_elements_promoters objects. Specify element</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co"># index, file name/location, and indicate mcol=TRUE to save object metadata with</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co"># the BED file.</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co"># NOT RUN</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="kw"><a href="../reference/ExportBED.html">ExportBED</a></span>(<span class="dt">obj =</span> linked_elements_promoters, <span class="dt">index =</span> <span class="dv">1</span>, <span class="dt">mcol =</span> <span class="ot">TRUE</span>, <span class="dt">file_name =</span> <span class="st">"promoter_linked_enhancers.bed"</span>)</a></code></pre></div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<ol style="list-style-type: decimal">
<li><p>Salameh TJ, Wang X, Song F, Zhang B, Wright SM. A supervised learning framework for chromatin loop detection in genome-wide contact maps. bioRxiv. 2019;1â€“25.</p></li>
<li><p>Rheinbay E, Nielsen MM, Abascal F, Tiao G, HornshÃ¸j H, Hess JM, et al.Â Discovery and characterization of coding and non-coding driver mutations in more than 2,500 whole cancer genomes. bioRxiv 2017;237313.</p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#background">Background</a></li>
      <li><a href="#creating-s3-element-and-loop-objects">Creating S3 Element and Loop Objects</a></li>
      <li><a href="#subsetting-loops-and-determining-consensus-sets">Subsetting Loops and Determining Consensus Sets</a></li>
      <li><a href="#finding-element-linkage-mediated-by-chromatin-loops">Finding Element Linkage Mediated by Chromatin Loops</a></li>
      <li><a href="#exporting-element-and-loop-data">Exporting Element and Loop Data</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Hassaan Maan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
